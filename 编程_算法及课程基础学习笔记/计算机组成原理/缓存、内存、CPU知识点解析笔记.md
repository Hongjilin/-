# #说明

> 查阅借鉴的资料:博客园的[缓存和内存的区别?](https://www.cnblogs.com/newcapecjmc/p/10280794.html)、简书的[缓存和内存的区别? (ROM？RAM?)](https://www.jianshu.com/p/fe38be062e16)、CSDN的[CPU，缓存，内存，外存全解析](https://blog.csdn.net/qq_40121580/article/details/107144304) 、百度知道的[外存和内存分别是什么 ](https://zhidao.baidu.com/question/37178116.html); HTML中文网的[静态ram和动态ram的区别是什么](https://www.html.cn/qa/other/21942.html)等

# 一、缓存

## 1、定义

>>###### **凡是为于速度相差较大的两种硬件之间,用于协调两者数据传输速度差异的结构,均可称之为`Cache`** (电脑高速缓冲存储器)
>
>* 缓存的存在是为了解决 CPU 和内存之间存取速度的差异的
>* 内存中被 CPU 访问最频繁的数据和指令会被复制到 CPU 的缓存中（这其中的“频繁”是由专门的算法来定义的
>* 这样 CPU 就不用去很慢的内存中读取需要的数据和指令了

## 2、被扩充概念

>###### 如今缓存的概念已被扩充
>
>* **CPU** 与 **主内存** 之间 (就我们常说的缓存)
>* **内存** 与 **硬盘** 之间 (磁盘缓存)
>* **硬盘** 与 **网络**之间 (称为**Internet** 临时文件夹或网络内容缓存等)

## 3、作用

>###### 用于协调两者数据传输速度差异的结构
>
>实例:
>
>* 缓存 是 CPU 的一部分
>* 缓存 是硬盘控制器上的一块内存芯片
>* 硬盘上的缓存: 当硬盘存取零碎数据时需要不断地在硬盘与内存之间交换数据

# 二、内存

## 1、什么是内存?

>**在计算机的组成结构中,有一个很重要的部分,就是存储器,那么他的具体概念是什么呢?** 
>
>1. 存储器是用来存储程序和数据的部件,对于计算机来说,有了存储器才有记忆功能,才能保证正常工作
>2. 存储器的种类很多,按照其用途可以分为 `主存储器` 和 `辅助存储器` 
>   - 主存储器又称为 **`内存储器`**(**就是我们常说的内存**) 
>   - 辅助存储器又成为 **`外存储器`** (**简称外存**)
>   - 所以实际上有很多人容易弄混淆这个概念,以为存储器就是内存

## 2、内存与外存

### Ⅰ - 外存 (ROM)

>>**外存通常是磁性介质或光盘: 如硬盘、软盘、磁带、CD等**
>
>* 能长期保存信息,且**不依赖于电**来保存信息,即断电不会失去保存的信息
>* 由于是机械部件带动,速度与CPU相比就显得慢得多
>* **`ROM`**（Read Only Memory） 只读内存，应用于硬盘存储

### Ⅱ - 内存 (RAM)

>> **物理实质就是一组或多组具备数据输入输出和数据存储功能的集成电路**
>
>* 指的是主板上的存储不见,是CPU直接与之沟通并用其存储数据的不见
>* 存放当前 正在使用的(**即执行中**) 的数据和程序
>* **它的物理实质就是一组或多组具备数据输入输出和数据存储功能的集成电路**
>* 内存只用于暂时存放程序和数据,一旦关闭电源或者发生断电,其中的程序和数据就会丢失
>* 随机存储器  **`RAM`**（Random Access Memory）俗称内存 

## 3、内存分类

>内存分为 **静态RAM** 和 **动态RAM**
>
>![image-20211011121001215](计算机组成原理笔记图片/image-20211011121001215.png) 
>
>**静态RAM** 速度比 **动态RAM** 快很多
>
>1. 速度比较：静态RAM > 动态RAM > ROM；缓存 > 内存 > 外存。

### Ⅰ - 静态RAM

>> **静态RAM，指SRAM：只要有供电，它保存的数据就不会丢失，且为高速存储器，如CPU中的高速缓存（cache）**
>
>缓存通常使用的是静态RAM, 不过由于静态RAM集成度低,因此便延申出一级缓存和二级缓存
>
>- 一级缓存为 静态RAM
>-  二级缓存为告诉动态RAM（比静态RAM慢，但比常规动态RAM要快）

### Ⅱ - 动态RAM

>>**动态RAM，指DRAM：有供电，还要根据它要求的刷新时间参数，才能保持存储的数据不丢失，如电脑中的内存条**
>
>现在使用的内存一般都是**动态RAM** 
>
>- 因为静态RAM集成度相对较低:存储相同数据量,静态RAM的提及是动态RAM的6倍之多,且价格高

### Ⅲ  -  动态RAM 与 静态RAM 的区别

> * 动态RAM 会周期地刷新,而 静态RAM 不会进行刷新
> * 动态RAM 是靠MOSS电路中的栅极电容来记忆信息的; 静态RAM 是靠双稳态触发器来记忆信息的
> * 由于电容上的电荷会泄露,需要定时给予补充. 所以 动态RAM 需要设置刷新电路,而静态不用
>
> ###### 应用上的区别
>
> * 动态RAM 比 静态RAM 集成度高、功耗低,从而成本也低,适用于做大容量储存器,所以**主内存通常采用动态RAM**
> * 另外:内存还应用于显卡、声卡及CMOS等设备中,用于充当设备缓存或保存固定的程序及数据
> * **高速缓冲存储器(Cache)则使用静态RAM** 



## 4、内存是如何工作的?

>> **既然内存是用来存放当前 正在使用的(即执行中) 的数据和程序,那么你可能会问:它是怎么工作的呢?**
>
>我们平常所提到的计算机内存指的是 **动态内存(即DRAM)** ,动态内存中所谓的 '**动态**' 指的是当我们将数据写入DRAM后,经过一段时间数据就会丢失,因此我们需要一个额外的电路进行内存刷新操作
>
>###### 具体工作过程是这样的:
>
>* 一个DRAM的存储单元存储的是0还是1取决于电容是否电荷. `有电荷代表1、无电荷代表0`
>* 但时间一长,代表 1 的电容会放电,代表 0 的电荷会吸收电荷 (**这就是数据丢失的原因**)
>* 刷新操作定期对电容进行检查,若电量大于满点亮的 **1/2** 则认为其代表 **1**, 并把电容充满
>* 定期刷新操作时,若电量小于 **1/2** 则认为其代表 **0**, 并把电容放电,籍此来保持数据的连续性

# 三、CPU

## 1、CPU的简单工作原理图

>![image-20211009180308915](计算机组成原理笔记图片/image-20211009180308915.png)
>
>**CPU 一般由控制单元、逻辑运算单元和存储单元(寄存器)组成（注意忽略了中断系统）** 
>
>CPU负责执行指令，是所有计算机硬件中速度最快的。一般用**时钟周期**（时钟频率）来衡量CPU的性能。

## 2、为什么需要缓存

>>**`CPU`**负责运算，`内存`负责暂时存储运算所涉及的东西，`高速缓存是CPU内部集成的小容量高速内存`
>>
>>**高速缓存**和内存的区别是，缓存容量极小，但是与**CPU**关系密切，所以传输速度比内存快得多
>
>* 缓存只是内存中少部分数据的复制品,所以CPU到缓存中寻找数据时也会出现找不到的情况(因为这些数据没用从内存复制到缓存中去)
>* 在这种缓存中找不到的情况下, CPU 还是会到内存中去找数据,这样系统的速度就会慢下来,不过**CPU会把这些数据复制到缓存中去**,以便下一次不用再到内存中去取,以此提高系统运行效率
>* 不过随着时间的变化,被访问得最频繁得数据不是一成不变的,也许昨天访问的不频繁的数据今天就非常频繁地进行了访问;
>* 所以说缓存中的数据经常要按照一定的算法来更换,这样才能保证缓存中的数据是被访问的最频繁的

## 3、作用

### Ⅰ - 缩短延迟

>访问缓存的时间应该尽可能缩短,可以通过多种的方式缩短这个时间:
>
>* 比如能够通过减少缓存的大小、关联性来降低缓存的延迟; 
>* 或者方法预测、增加宽带等

### Ⅱ - 提高命中率

>所谓命中率是在高速缓存中找到内存引用的速率,我们希望能够首先通过缓存中获得信息以得到速度的优势;
>
>所以缓存需要最大限度地实现这一目标
>
>对于单个高速缓存来说:大小、关联性和块大小决定命中率

### Ⅲ - 降低更低级别内存下的开销

>高速缓存是内存层次结构的一部分,其性能会影响其他性能,处理其他内存花费的时间越长意味着系统性能越低
>
>也就是说尽可能地让处理在缓存中完成

### Ⅳ - 减少错失惩罚

>缓存中不能命中是无法避免的事情,但是我们可以减少处理未命中所需地时间以获得更好的处理器性能,通过提升命中率与不同的优化能有效降低错失惩罚
>
> 高速缓存是CPU中十分重要的部分,占据了大量的资源开销和成本,如果咱看过CPU架构图的话就会发现缓存占据了至少50%的面积,绝对至关重要



## 4、时钟周期与指令周期

>**`CPU时钟周期`** 是操作的最小时间单位,值是主频的倒数,现代计算机的主频可以达到几GHZ.
>
>**`指令周期`**是取出并执行一个指令的时间单位,一个指令需要多个 CPU 操作来执行,一般来说一个指令周期至少包含2个CPU时钟周期(取指 + 执行)
>
>同一个硬件架构下不同CPU的时钟周期越高,相同时间内能够执行的指令越多,性能就越好; 但在不同硬件架构下只比较CPU主频大小意义不大，处理器结构不同，指令集就不同，相同意义的指令所需的CPU时钟周期也就不同
>
>除了计算机架构不同外，在比较计算机整体性能的时候还需要考虑很多因素，例如[前端总线](https://zh.wikipedia.org/wiki/前端总线)（"front side bus"，FSB），**内存的时钟周期**，CPU[通用寄存器](https://zh.wikipedia.org/w/index.php?title=通用寄存器&action=edit&redlink=1)的数据宽度和机器的一级、二级[缓存](https://zh.wikipedia.org/wiki/缓存)等。



## 5、存储单元(寄存器)

>寄存器是CPU的内部组成单元,是CPU运算时取 **指令** 和 **数据** 的地方,速度很快.
>
>> * 可以理解成对于 CPU 来说, **对寄存器进行 读/写 是不需要时间的**
>> * 或者说如果只是操作寄存器 (比如类似mov BX,AX之类的操作),那么一秒钟执行的指令个数理论上等于主频,因为寄存器是CPU的一部分
>
>###### 寄存器可以用来暂存指令、数据和地址. 在CPU中分为
>
>* **通用寄存器**: 如指令寄存器`IR`; 
>* **特殊功能寄存器** : 如程序计数器`PC 、sp`等



## 6、CPU的多级缓存(高速缓存)

>**Cache** 一词来源于1967年的一篇电子工程期刊论文
>
>> ###### 高速缓存（cache）通常分为L1,L2,L3三级，速度递减，容量递增，是为了弥补CPU与内存之间运算速度的差异而设置的硬件
>
>CPU的核心数量、高频高低都会影响性能，但如果让CPU更聪明、更有效率的执行计算任务，那么缓存的作用就至关重要了

### Ⅰ - 作用

>当 **CPU** 处理数据是,它会先到 **Cache** 中去寻找,如果数据因之前的操作已经读取而被暂存其中的话就不必再从主内存中读取数据
>
>* 由于 CPU 的运行速度一般比主内存的读取速度快.主存 **时钟周期**(访问主存储器所需要时间) 为数个 CPU 时钟周期
>* 因此如果要访问主内存的话,就必须等待数个CPU周期从而造成浪费
>* **L1缓存** 的速度可以再 2-4 个CPU时钟频率内完成,速度很快
>
>Linux下可以通过 `lscpu` 命令来查看 CPU 的信息,其中就包括 Cache 层次

### Ⅱ - 原理

>提供 '**缓存**' 的目的是为了让数据访问的速度适应 CPU 的处理速度
>
>通常它不像系统主存那样使用 **`DRAM(动态)`** 技术,而是使用 **昂贵但比较快速** 的 **`SRAM(静态)`** 技术,其原理是:
>
>* 内存中 '**程序执行与数据访问的局域性行为**', 即一定程序执行时间和空间内,被访问的代码集中于一部分
>* 为了充分发挥缓存的作用,不仅依靠 '**暂存刚刚访问过的数据**', 还要
>
>

